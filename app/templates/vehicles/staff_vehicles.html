{% extends "layouts/base.html" %}
{% block content %}
    <h3>Manage Vehicles</h3>
    <form class="row g-2 mb-3" method="post" action="/staff/vehicles/add">
        <div class="col-md-2"><input class="form-control" name="brand" placeholder="brand" required/></div>
        <div class="col-md-2"><input class="form-control" name="model" placeholder="model" required/></div>
        <div class="col-md-2">
            <select class="form-select" name="type" required>
                <option value="car">car</option>
                <option value="motorbike">motorbike</option>
                <option value="truck">truck</option>
            </select>
        </div>
        <div class="col-md-2"><input class="form-control" name="rate" placeholder="rate/day" required/></div>
        <div class="col-md-3"><input class="form-control" name="image_path"
                                     placeholder="http/https or /static/..."/></div>
        <div class="col-md-1">
            <button class="btn btn-primary w-100">Add</button>
        </div>
    </form>
    <table class="table table-striped">
        <thead>
        <tr>
            <th>vehicle_id</th>
            <th>brand</th>
            <th>model</th>
            <th>type</th>
            <th>rate</th>
            <th>status</th>
            <th>Detail</th>
            <th></th>
        </tr>
        </thead>
        <tbody>
        {% for v in vehicles %}
            <tr>
                <td>{{ v.vehicle_id }}</td>
                <td>{{ v.brand }}</td>
                <td>{{ v.model }}</td>
                <td>{{ v.type }}</td>
                <td>{{ '%.2f'|format(v.rate) }}</td>
                <td>
                    <span class="badge
                      {% if v.status=='rented' %} text-bg-primary
                      {% elif v.status=='overdue' %} text-bg-danger
                      {% elif v.status=='returned' %} text-bg-success
                      {% elif v.status=='cancelled' %} text-bg-secondary
                      {% else %} text-bg-light
                      {% endif %}">
                        {{ v.status | default('available', true) }}
                    </span>
                    {% if v.status == 'overdue' and v.overdue_days %}
                        <small class="text-danger ms-1">
                            ({{ v.overdue_days }} day{{ 's' if v.overdue_days|int != 1 }})
                        </small>
                    {% endif %}
                </td>
                <td><a class="btn btn-sm btn-outline-secondary" href="/vehicles/{{ v.vehicle_id }}">View</a></td>
                <td>
                    <form method="post" action="/staff/vehicles/delete">
                        <input type="hidden" name="vehicle_id" value="{{ v.vehicle_id }}"/>
                        <button class="btn btn-sm btn-outline-danger"
                                onclick="return confirm('Are you sure you want to delete this vehicle?');">Delete
                        </button>
                    </form>
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% endblock %}